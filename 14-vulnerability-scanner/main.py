#!/usr/bin/env python

"""
Ver: Python3

vulnerability scanner. Main features:
- it finds every possible links on the website
- look for ways to send data to the web application
- send payload to discover vulnerabilities
- analyse the response to check if the website is vulnerable
"""

import scanner


#target_url = "http://192.168.1.101/mutillidae/"
target_url = "http://192.168.1.101/dvwa/"
links_to_ignore = ["http://192.168.1.101/dvwa/logout.php"]

data_dict = {"username":"admin", "password":"password", "Login": "submit"}

vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
vuln_scanner.session.post("http://192.168.1.101/dvwa/login.php", data=data_dict)

vuln_scanner.crawl()
vuln_scanner.run_scanner()



#response = vuln_scanner.submit_form(forms[0], "testtest", "http://192.168.1.101/dvwa/vulnerabilities/xss_r/")
#response = vuln_scanner.test_xss_in_form(forms[0], "http://192.168.1.101/dvwa/vulnerabilities/xss_r/" )
#response = vuln_scanner.test_xss_in_link("http://192.168.1.101/dvwa/vulnerabilities/xss_r/?name=test" )
